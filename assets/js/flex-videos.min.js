(function($){"use strict";$(document).ready(function(){initFlexVideos()});function initFlexVideos(){makeVideosResponsive();handleLazyLoading();hidePlayButtonOverlays();addClickTracking()}function hidePlayButtonOverlays(){$(".flex-videos-item .ytp-large-play-button, .flex-videos-item .ytp-play-button, .flex-videos-item .ytp-cued-thumbnail-overlay").hide()}function makeVideosResponsive(){$(".flex-video-single iframe").each(function(){var $iframe=$(this);var width=$iframe.attr("width");var height=$iframe.attr("height");if(width&&height){var aspectRatio=height/width*100;$iframe.wrap('<div class="flex-video-responsive" style="position: relative; padding-bottom: '+aspectRatio+'%; height: 0; overflow: hidden;"></div>');$iframe.css({position:"absolute",top:"0",left:"0",width:"100%",height:"100%"})}})}function handleLazyLoading(){if("IntersectionObserver"in window){var lazyVideoObserver=new IntersectionObserver(function(entries){entries.forEach(function(entry){if(entry.isIntersecting){var lazyVideo=entry.target;var src=lazyVideo.getAttribute("data-src");if(src){lazyVideo.setAttribute("src",src);lazyVideo.removeAttribute("data-src");lazyVideoObserver.unobserve(lazyVideo)}}})});$(".flex-video-single iframe[data-src]").each(function(){lazyVideoObserver.observe(this)})}}function addClickTracking(){$(".flex-video-single").on("click",function(){var videoTitle=$(this).find(".flex-video-title").text()||"Unknown Video";if(typeof gtag!=="undefined"){gtag("event","video_click",{video_title:videoTitle,event_category:"flex_videos",event_label:videoTitle})}if(typeof ga!=="undefined"){ga("send","event","Flex Videos","Video Click",videoTitle)}})}if($(".flex-videos-admin").length>0){$("#reset-cache-btn").on("click",function(e){e.preventDefault();var $btn=$(this);var originalText=$btn.text();$btn.text("Resetting...").prop("disabled",true);$.ajax({url:flexVideosAjax.ajaxurl,type:"POST",data:{action:"flex_videos_reset_cache",nonce:flexVideosAjax.nonce},success:function(response){if(response.success){$btn.text("Cache Reset!").addClass("button-primary");setTimeout(function(){$btn.text(originalText).removeClass("button-primary").prop("disabled",false)},2e3)}else{alert("Error resetting cache: "+response.data);$btn.text(originalText).prop("disabled",false)}},error:function(){alert("Error resetting cache. Please try again.");$btn.text(originalText).prop("disabled",false)}})})}})(jQuery);
